(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const s of c.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function o(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerPolicy&&(c.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?c.credentials="include":r.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(r){if(r.ep)return;r.ep=!0;const c=o(r);fetch(r.href,c)}})();const L={".-":"A","-...":"B","-.-.":"C","-..":"D",".":"E","..-.":"F","--.":"G","....":"H","..":"I",".---":"J","-.-":"K",".-..":"L","--":"M","-.":"N","---":"O",".--.":"P","--.-":"Q",".-.":"R","...":"S","-":"T","..-":"U","...-":"V",".--":"W","-..-":"X","-.--":"Y","--..":"Z","-----":"0",".----":"1","..---":"2","...--":"3","....-":"4",".....":"5","-....":"6","--...":"7","---..":"8","----.":"9",".-.-.-":".","--..--":",","..--..":"?","-.-.--":"!","-..-.":"/","-.--.":"(","-.--.-":")",".-...":"&","---...":":","-.-.-.":";","-...-":"=",".-.-.":"+","-....-":"-","..--.-":"_",".-..-.":'"',"...-..-":"$",".--.-.":"@"},Y=Object.entries(L).reduce((t,[n,o])=>(t[o]=n,t),{}),D=10,R=["CQ CQ DE N0CALL K","UR RST 579 QTH DENVER CO","NAME ALEX RIG KX2 ANT EFHW","WX HR SUNNY 72F","TNX QSO 73 ES GL","QTH SEATTLE WA","RIG IC-7300 100W","ANT DIPOLE 40M","FB COPY?","BTU TU SK"],e={keyDown:!1,downAt:0,lastUpAt:0,currentSymbols:"",decoded:"",symbolStream:"",charTimer:null,wordTimer:null,sendTimer:null,audioContext:null,audio:null,remoteQueue:Promise.resolve(),chatHistory:[],localProfile:null,intraGapMs:null,charWpm:22,effWpm:16,tone:650,volume:.35,attackMs:6,releaseMs:18,clickLevel:.2,qsbDepth:.1,qsbRate:.3,qrmLevel:.08,adaptiveTiming:!0,autoSpacing:!0,trainingMode:!1,allowTypedDecoded:!1,autoSpacingBeforePractice:!0,practiceMode:!1,estimatedUnitMs:null,practicePrompt:R[0],keyCode:"ControlLeft"},a={keyZone:document.getElementById("keyZone"),keyIndicator:document.getElementById("keyIndicator"),keyLabel:document.getElementById("keyLabel"),symbolStream:document.getElementById("symbolStream"),decodedStream:document.getElementById("decodedStream"),confirmSend:document.getElementById("confirmSend"),typeDecoded:document.getElementById("typeDecoded"),typeDecodedWrap:document.getElementById("typeDecodedWrap"),clearMessage:document.getElementById("clearMessage"),transcript:document.getElementById("transcript"),callCq:document.getElementById("callCq"),resetRagchew:document.getElementById("resetRagchew"),keyCode:document.getElementById("keyCode"),charWpm:document.getElementById("charWpm"),charWpmInput:document.getElementById("charWpmInput"),effWpm:document.getElementById("effWpm"),effWpmInput:document.getElementById("effWpmInput"),tone:document.getElementById("tone"),toneInput:document.getElementById("toneInput"),volume:document.getElementById("volume"),volumeInput:document.getElementById("volumeInput"),attack:document.getElementById("attack"),attackInput:document.getElementById("attackInput"),release:document.getElementById("release"),releaseInput:document.getElementById("releaseInput"),click:document.getElementById("click"),clickInput:document.getElementById("clickInput"),qsbDepth:document.getElementById("qsbDepth"),qsbDepthInput:document.getElementById("qsbDepthInput"),qsbRate:document.getElementById("qsbRate"),qsbRateInput:document.getElementById("qsbRateInput"),qrm:document.getElementById("qrm"),qrmInput:document.getElementById("qrmInput"),adaptiveTiming:document.getElementById("adaptiveTiming"),autoSpacing:document.getElementById("autoSpacing"),trainingMode:document.getElementById("trainingMode"),practiceMode:document.getElementById("practiceMode"),practicePrompt:document.getElementById("practicePrompt"),newPrompt:document.getElementById("newPrompt"),myCall:document.getElementById("myCall"),theirCall:document.getElementById("theirCall"),stationStyle:document.getElementById("stationStyle"),unlockAudio:document.getElementById("unlockAudio"),audioStatus:document.getElementById("audioStatus"),llmEnabled:document.getElementById("llmEnabled"),llmEndpoint:document.getElementById("llmEndpoint"),llmKey:document.getElementById("llmKey"),llmModel:document.getElementById("llmModel")};function A(){return 1200/e.charWpm}function g(t,n,o){return Math.min(Math.max(t,n),o)}function Z(){return 1200/e.effWpm}function S(){if(!e.adaptiveTiming||!e.estimatedUnitMs)return A();const t=A(),n=t*.6,o=t*1.6;return Math.min(Math.max(e.estimatedUnitMs,n),o)}function P(){return e.intraGapMs||S()}function _(){return e.trainingMode?4.5:3.2}function j(){return e.trainingMode?12:10}function l(){var t;a.charWpm.value=String(e.charWpm),a.effWpm.value=String(e.effWpm),a.charWpmInput.value=String(e.charWpm),a.effWpmInput.value=String(e.effWpm),a.tone.value=String(e.tone),a.toneInput.value=String(e.tone),a.volume.value=String(Math.round(e.volume*100)),a.volumeInput.value=String(Math.round(e.volume*100)),a.attack.value=String(e.attackMs),a.attackInput.value=String(e.attackMs),a.release.value=String(e.releaseMs),a.releaseInput.value=String(e.releaseMs),a.click.value=String(Math.round(e.clickLevel*100)),a.clickInput.value=String(Math.round(e.clickLevel*100)),a.qsbDepth.value=String(Math.round(e.qsbDepth*100)),a.qsbDepthInput.value=String(Math.round(e.qsbDepth*100)),a.qsbRate.value=String(Math.round(e.qsbRate*100)),a.qsbRateInput.value=e.qsbRate.toFixed(2),a.qrm.value=String(Math.round(e.qrmLevel*100)),a.qrmInput.value=String(Math.round(e.qrmLevel*100)),a.practicePrompt.textContent=e.practicePrompt,a.keyLabel.textContent=((t=a.keyCode.selectedOptions[0])==null?void 0:t.textContent)||"Left Ctrl"}function U(){a.confirmSend.classList.toggle("is-hidden",!e.trainingMode),a.trainingMode.checked=e.trainingMode,a.typeDecodedWrap.classList.toggle("is-hidden",!e.trainingMode),e.trainingMode||(e.allowTypedDecoded=!1,a.typeDecoded.checked=!1,w(!1))}function w(t){a.decodedStream.contentEditable=t?"true":"false",a.decodedStream.classList.toggle("editable",t)}function b(){e.effWpm>e.charWpm&&(e.effWpm=e.charWpm)}function F(t){a.keyIndicator.textContent=t?"Key Down":"Idle",a.keyIndicator.style.background=t?"#f06c3d":"#fff",a.keyIndicator.style.color=t?"#fff":"#1b1a17",a.keyZone.classList.toggle("active",t)}function q(){e.audioContext||(e.audioContext=new(window.AudioContext||window.webkitAudioContext)),e.audioContext.state==="suspended"&&e.audioContext.resume(),z(),a.audioStatus.textContent=e.audioContext.state==="running"?"Ready":"Locked"}function J(t){const n=t.createBuffer(1,t.sampleRate*2,t.sampleRate),o=n.getChannelData(0);for(let i=0;i<o.length;i+=1)o[i]=Math.random()*2-1;return n}function z(){if(e.audio||!e.audioContext)return;const t=e.audioContext,n=t.createOscillator();n.type="sine";const o=t.createGain();o.gain.value=0;const i=t.createOscillator();i.type="sine";const r=t.createGain();r.gain.value=0;const c=t.createGain();c.gain.value=1;const s=t.createGain();s.gain.value=e.volume,n.connect(o).connect(c),i.connect(r).connect(c),c.connect(s).connect(t.destination);const d=t.createBufferSource();d.buffer=J(t),d.loop=!0;const u=t.createBiquadFilter();u.type="bandpass",u.Q.value=1.2;const m=t.createGain();m.gain.value=e.qrmLevel,d.connect(u).connect(m).connect(c);const f=t.createOscillator();f.type="sine";const v=t.createGain();f.connect(v).connect(c.gain),n.start(),i.start(),d.start(),f.start(),e.audio={toneOsc:n,gateGain:o,remoteOsc:i,remoteGateGain:r,qsbGain:c,masterGain:s,noiseSource:d,noiseFilter:u,noiseGain:m,qsbLfo:f,qsbLfoGain:v},p()}function p(){if(!e.audioContext||!e.audio)return;const n=e.audioContext.currentTime;e.audio.toneOsc.frequency.setTargetAtTime(e.tone,n,.01),e.audio.remoteOsc.frequency.setTargetAtTime(e.tone,n,.01),e.audio.masterGain.gain.setTargetAtTime(e.volume,n,.02),e.audio.noiseFilter.frequency.setTargetAtTime(e.tone,n,.01),e.audio.noiseGain.gain.setTargetAtTime(e.qrmLevel,n,.02);const o=e.qsbDepth;e.audio.qsbGain.gain.setTargetAtTime(1-o/2,n,.05),e.audio.qsbLfoGain.gain.setTargetAtTime(o/2,n,.05),e.audio.qsbLfo.frequency.setTargetAtTime(e.qsbRate,n,.05)}function H(t,n){if(!e.audioContext||!e.audio)return;const o=e.audioContext.currentTime,i=Math.max(n/1e3,.001);e.audio.gateGain.gain.cancelScheduledValues(o),e.audio.gateGain.gain.setTargetAtTime(t,o,i)}function G(t,n,o,i){const r=Math.max(e.attackMs/1e3,.001),c=Math.max(e.releaseMs/1e3,.001),s=Math.max(o-c,n+r);t.setValueAtTime(0,n),t.linearRampToValueAtTime(i,n+r),t.setValueAtTime(i,s),t.linearRampToValueAtTime(0,o)}function Q(){if(!e.audioContext||!e.audio||e.clickLevel<=0)return;const t=e.audioContext,n=t.createOscillator(),o=t.createGain();n.type="square",n.frequency.value=2e3,o.gain.value=1e-4,n.connect(o).connect(e.audio.masterGain);const i=t.currentTime,r=.08*e.clickLevel;o.gain.setValueAtTime(1e-4,i),o.gain.exponentialRampToValueAtTime(r,i+.002),o.gain.exponentialRampToValueAtTime(1e-4,i+.02),n.start(i),n.stop(i+.04)}function ee(){q(),H(1,e.attackMs),Q()}function te(){H(0,e.releaseMs),Q()}function K(t,n){if(q(),!e.audioContext||!e.audio)return;const o=e.audioContext.currentTime+.05,i=t.toUpperCase();let r=o;const c=1;for(const s of i){if(s===" "){r+=n*4/1e3;continue}const d=Y[s];if(d){for(const u of d)if(u==="."){const m=r+n/1e3;G(e.audio.remoteGateGain.gain,r,m,c),r=m+n/1e3}else if(u==="-"){const m=r+n*3/1e3;G(e.audio.remoteGateGain.gain,r,m,c),r=m+n/1e3}r+=n*2/1e3}}}function ne(){if(clearTimeout(e.charTimer),clearTimeout(e.wordTimer),clearTimeout(e.sendTimer),!(e.autoSpacing||e.practiceMode))return;const t=P();e.charTimer=setTimeout(()=>{k()},t*_()),e.wordTimer=setTimeout(()=>{e.decoded&&!e.decoded.endsWith(" ")&&(e.decoded+=" ",E())},t*j()),e.trainingMode||(e.sendTimer=setTimeout(()=>{!e.trainingMode&&!e.keyDown&&e.decoded.trim()&&V()},Math.max(Z()*12,4e3)))}function ae(t){const n=S();t<n*.5||t>n*2.2||(e.intraGapMs=e.intraGapMs?e.intraGapMs*.8+t*.2:t)}function k(){if(!e.currentSymbols)return;const t=oe(e.currentSymbols);e.decoded+=t,e.currentSymbols="",E()}function oe(t){const n=L[t];if(n)return n;const o=re(t);return o?o.join(""):"?"}function re(t){const n=new Map,o=Object.keys(L),i=r=>{if(r===t.length)return[];if(n.has(r))return n.get(r);let c=null;for(const s of o)if(t.startsWith(s,r)){const d=i(r+s.length);if(d){const u=[L[s],...d];(!c||u.length<c.length)&&(c=u)}}return n.set(r,c),c};return i(0)}function ie(t){e.currentSymbols+=t,e.symbolStream=e.currentSymbols,E()}function E(){a.symbolStream.textContent=e.currentSymbols||" ",e.allowTypedDecoded&&document.activeElement===a.decodedStream||(a.decodedStream.textContent=e.decoded||" ")}function ce(t){if(!e.adaptiveTiming)return;const n=A(),o=e.estimatedUnitMs||n,i=t<o*1.8?t:t/3,r=Math.min(Math.max(i,n*.5),n*2);e.estimatedUnitMs=e.estimatedUnitMs?o*.8+r*.2:r}function x(){if(!e.keyDown){if((e.autoSpacing||e.practiceMode)&&e.lastUpAt){const t=performance.now()-e.lastUpAt;ae(t);const n=P();t>=n*(e.trainingMode?10:8)?(k(),e.decoded&&!e.decoded.endsWith(" ")&&(e.decoded+=" ",E())):t>=n*(e.trainingMode?4.5:3)&&k()}e.keyDown=!0,e.downAt=performance.now(),F(!0),ee(),clearTimeout(e.charTimer),clearTimeout(e.wordTimer),clearTimeout(e.sendTimer)}}function M(){if(!e.keyDown)return;e.keyDown=!1;const t=performance.now()-e.downAt;e.lastUpAt=performance.now(),F(!1),te(),ce(t);const n=t<S()*1.8;ie(n?".":"-"),ne()}function le(){document.addEventListener("keydown",t=>{t.code===e.keyCode&&(t.preventDefault(),x())}),document.addEventListener("keyup",t=>{t.code===e.keyCode&&(t.preventDefault(),M())}),a.keyZone.addEventListener("pointerdown",t=>{a.keyZone.setPointerCapture(t.pointerId),x()}),a.keyZone.addEventListener("pointerup",t=>{a.keyZone.releasePointerCapture(t.pointerId),M()}),a.keyZone.addEventListener("pointerleave",()=>{M()}),a.keyZone.addEventListener("pointercancel",()=>{M()})}function T(t,n){const o=document.createElement("div");o.className=`bubble ${n==="me"?"me":""}`,n==="them"&&(o.classList.add("blurred"),o.addEventListener("click",()=>{o.classList.remove("blurred")},{once:!0}));const i=document.createElement("div");i.className="meta",i.textContent=n==="me"?a.myCall.value:a.theirCall.value;const r=document.createElement("div");r.textContent=t,o.appendChild(i),o.appendChild(r),a.transcript.appendChild(o),a.transcript.scrollTop=a.transcript.scrollHeight}function N(){e.currentSymbols="",e.decoded="",e.symbolStream="",E()}function se(){a.transcript.innerHTML="",e.chatHistory=[],e.localProfile=null,N()}const de={friendly:{greeting:"GM {their} DE {me} {me} K",acknowledgments:["RGR {their} UR RST {rst} QTH {qth}","FB {their} RST {rst} QTH {qth}","R RST {rst} QTH {qth}"],followups:["WX HR {wx}, ANT {ant}","RIG {rig} {pwr} INTO {ant}","OP {op} NAME {op}","ENJOYING {hobby}"],signoff:"TNX QSO {their} 73 ES GL DE {me} SK"},brief:{greeting:"{their} DE {me} R RST 599 599 QTH CHICAGO IL",acknowledgments:["RGR {their} FB","R RST {rst}","OK FB"],followups:["WX {wx}","RIG {rig} {pwr}","ANT {ant}"],signoff:"TU {their} 73 DE {me} SK"},dx:{greeting:"{their} DE {me} {me} K",acknowledgments:["UR {rst} HR","R RST {rst}","QSB BUT COPY OK"],followups:["QTH {qth}","RIG {rig} {pwr}","ANT {ant}"],signoff:"TNX DX {their} 73 DE {me} SK"}},h={rst:["559","569","579","589","599"],qth:["PORTLAND OR","DENVER CO","AUSTIN TX","RALEIGH NC","BOSTON MA"],wx:["SUNNY 72F","CLR 65F","OVERCAST 58F","WINDY 60F","RAIN 55F"],rig:["KX2","IC-7300","FT-891","K3","TS-590"],ant:["EFHW AT 30FT","DIPOLE AT 40FT","VERTICAL","YAGI 3EL","INV VEE"],pwr:["50W","100W","20W","5W"],hobby:["QRP NIGHTS","OLD RIGS","FIELD OPS","POTA","ANT EXPERIMENTS"],op:["ALEX","JIM","PAT","KIM","SAM"]};function y(t){return t[Math.floor(Math.random()*t.length)]}function $(){const t=a.theirCall.value.trim()||"K2RAG";return(!e.localProfile||e.localProfile.call!==t)&&(e.localProfile={call:t,rst:y(h.rst),qth:y(h.qth),wx:y(h.wx),rig:y(h.rig),ant:y(h.ant),pwr:y(h.pwr),hobby:y(h.hobby),op:y(h.op)}),e.localProfile}function ue(t){const n=a.stationStyle.value,o=de[n],i=$(),r=i.call,c=a.myCall.value||"N0CALL",s=t.includes("CQ"),d=I=>I.replaceAll("{me}",r).replaceAll("{their}",c).replaceAll("{rst}",i.rst).replaceAll("{qth}",i.qth).replaceAll("{wx}",i.wx).replaceAll("{rig}",i.rig).replaceAll("{ant}",i.ant).replaceAll("{pwr}",i.pwr).replaceAll("{hobby}",i.hobby).replaceAll("{op}",i.op),u=d(o.greeting),m=d(o.acknowledgments[Math.floor(Math.random()*o.acknowledgments.length)]),f=d(o.followups[Math.floor(Math.random()*o.followups.length)]),v=d(o.signoff);return s?`${u} ${m}`:t.includes("73")||t.includes("SK")?v:t.includes("WX")||t.includes("QTH")?`${m} ${f}`:`${m} ${f}`}async function me(t){var f,v,I,W,B;const n=a.llmEndpoint.value.trim()||"https://api.openai.com/v1/chat/completions",o=a.llmKey.value.trim(),i=a.llmModel.value.trim()||"gpt-5-mini";if(!o)return"LLM not configured";const r=$(),c=`Station profile (keep consistent): CALL ${r.call}, QTH ${r.qth}, RST ${r.rst}, WX ${r.wx}, RIG ${r.rig} ${r.pwr}, ANT ${r.ant}, OP ${r.op}.`,s={model:i,messages:[{role:"system",content:"You are a friendly HF CW operator in a ragchew. Keep replies short and natural (1-3 sentences). Use common CW abbreviations (e.g., R, RGR, FB, WX, QTH, QRM, QSB, RST, NAME, OP, RIG, ANT, PWR, HW CPY, TNX, 73). Always include a plausible RST and QTH early in the exchange. Ask occasional questions to keep the ragchew going. Keep callsigns intact and repeat them occasionally. Avoid markdown; return plain text only. "+c},...e.chatHistory,{role:"user",content:t}],max_tokens:120,temperature:.7},d=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(s)});if(!d.ok)return`LLM error ${d.status}`;const u=await d.json();return((W=(I=(v=(f=u.choices)==null?void 0:f[0])==null?void 0:v.message)==null?void 0:I.content)==null?void 0:W.trim())||((B=u.text)==null?void 0:B.trim())||"LLM had no response."}function C(t,n){e.chatHistory.push({role:t,content:n}),e.chatHistory.length>D&&(e.chatHistory=e.chatHistory.slice(-D))}async function X(t){if(a.llmEnabled.checked)try{const n=await me(t);if(!n.startsWith("LLM error")&&n!=="LLM not configured")return n}catch{}return ue(t)}async function V(){k();const t=e.decoded.trim();if(!t)return;if(T(t,"me"),N(),e.practiceMode){T(`PRACTICE TARGET: ${e.practicePrompt}`,"them");return}const n=S(),o=t.toUpperCase();C("user",o);const i=await X(o);C("assistant",i),T(i,"them"),e.remoteQueue=e.remoteQueue.then(()=>{K(i,n)})}async function pe(){if(e.practiceMode)return;const t=a.myCall.value.trim()||"N0CALL",n=`CQ CQ CQ DE ${t} ${t} K`;T(n,"me");const o=S(),i=n.toUpperCase();C("user",i);const r=await X(i);C("assistant",r),T(r,"them"),e.remoteQueue=e.remoteQueue.then(()=>{K(r,o)})}function O(){e.practicePrompt=R[Math.floor(Math.random()*R.length)],a.practicePrompt.textContent=e.practicePrompt}function fe(){a.charWpm.addEventListener("input",t=>{e.charWpm=Number(t.target.value),e.estimatedUnitMs=null,e.intraGapMs=null,b(),a.charWpmInput.value=String(e.charWpm),a.effWpm.value=String(e.effWpm),a.effWpmInput.value=String(e.effWpm),l()}),a.charWpmInput.addEventListener("change",t=>{const n=Number(t.target.value);Number.isFinite(n)&&(e.charWpm=Math.min(Math.max(n,10),40),a.charWpm.value=String(e.charWpm),e.estimatedUnitMs=null,e.intraGapMs=null,b(),a.effWpm.value=String(e.effWpm)),l()}),a.effWpm.addEventListener("input",t=>{e.effWpm=Number(t.target.value),b(),a.effWpm.value=String(e.effWpm),a.effWpmInput.value=String(e.effWpm),l()}),a.effWpmInput.addEventListener("change",t=>{const n=Number(t.target.value);Number.isFinite(n)&&(e.effWpm=Math.min(Math.max(n,5),30),b(),a.effWpm.value=String(e.effWpm)),l()}),a.keyCode.addEventListener("change",t=>{e.keyCode=t.target.value,l()}),a.tone.addEventListener("input",t=>{e.tone=Number(t.target.value),l(),p()}),a.toneInput.addEventListener("change",t=>{const n=Number(t.target.value);Number.isFinite(n)&&(e.tone=g(n,350,900),a.tone.value=String(e.tone),l(),p())}),a.volume.addEventListener("input",t=>{e.volume=Number(t.target.value)/100,l(),p()}),a.volumeInput.addEventListener("change",t=>{const n=Number(t.target.value);if(Number.isFinite(n)){const o=g(n,0,100);e.volume=o/100,a.volume.value=String(o),l(),p()}}),a.attack.addEventListener("input",t=>{e.attackMs=Number(t.target.value),l()}),a.attackInput.addEventListener("change",t=>{const n=Number(t.target.value);Number.isFinite(n)&&(e.attackMs=g(n,1,30),a.attack.value=String(e.attackMs),l())}),a.release.addEventListener("input",t=>{e.releaseMs=Number(t.target.value),l()}),a.releaseInput.addEventListener("change",t=>{const n=Number(t.target.value);Number.isFinite(n)&&(e.releaseMs=g(n,5,60),a.release.value=String(e.releaseMs),l())}),a.click.addEventListener("input",t=>{e.clickLevel=Number(t.target.value)/100,l()}),a.clickInput.addEventListener("change",t=>{const n=Number(t.target.value);if(Number.isFinite(n)){const o=g(n,0,100);e.clickLevel=o/100,a.click.value=String(o),l()}}),a.qsbDepth.addEventListener("input",t=>{e.qsbDepth=Number(t.target.value)/100,l(),p()}),a.qsbDepthInput.addEventListener("change",t=>{const n=Number(t.target.value);if(Number.isFinite(n)){const o=g(n,0,100);e.qsbDepth=o/100,a.qsbDepth.value=String(o),l(),p()}}),a.qsbRate.addEventListener("input",t=>{e.qsbRate=Number(t.target.value)/100,l(),p()}),a.qsbRateInput.addEventListener("change",t=>{const n=Number(t.target.value);Number.isFinite(n)&&(e.qsbRate=g(n,.1,1.2),a.qsbRate.value=String(Math.round(e.qsbRate*100)),l(),p())}),a.qrm.addEventListener("input",t=>{e.qrmLevel=Number(t.target.value)/100,l(),p()}),a.qrmInput.addEventListener("change",t=>{const n=Number(t.target.value);if(Number.isFinite(n)){const o=g(n,0,100);e.qrmLevel=o/100,a.qrm.value=String(o),l(),p()}}),a.adaptiveTiming.addEventListener("change",t=>{e.adaptiveTiming=t.target.checked,e.estimatedUnitMs=null}),a.autoSpacing.addEventListener("change",t=>{e.autoSpacing=t.target.checked}),a.trainingMode.addEventListener("change",t=>{e.trainingMode=t.target.checked,U(),e.trainingMode&&clearTimeout(e.sendTimer)}),a.typeDecoded.addEventListener("change",t=>{e.allowTypedDecoded=t.target.checked,w(e.allowTypedDecoded),e.allowTypedDecoded||E()}),a.decodedStream.addEventListener("input",()=>{e.allowTypedDecoded&&(e.decoded=a.decodedStream.textContent.replace(/\s+/g," ").trim())}),a.practiceMode.addEventListener("change",t=>{e.practiceMode=t.target.checked,e.practiceMode?(e.autoSpacingBeforePractice=e.autoSpacing,e.autoSpacing=!0,a.autoSpacing.checked=!0,a.autoSpacing.disabled=!0,O()):(a.autoSpacing.disabled=!1,e.autoSpacing=e.autoSpacingBeforePractice,a.autoSpacing.checked=e.autoSpacing)}),a.newPrompt.addEventListener("click",()=>{O()}),a.clearMessage.addEventListener("click",()=>{N()}),a.confirmSend.addEventListener("click",()=>{V()}),a.callCq.addEventListener("click",()=>{pe()}),a.resetRagchew.addEventListener("click",()=>{se()}),a.theirCall.addEventListener("change",()=>{e.localProfile=null}),a.unlockAudio.addEventListener("click",()=>{q(),a.audioStatus.textContent="Ready"})}function ge(){e.trainingMode=!1,l(),E(),le(),fe(),U(),w(!1)}ge();
